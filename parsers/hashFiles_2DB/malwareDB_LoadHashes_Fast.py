import mysql.connector
import sys
# This script takes a file argument and loads data into the database
#
# this must be run with db using special local infile argument
# mysql -u user -p mydatabase --local-infile=1
#
mydb = mysql.connector.connect(
    host="localhost",
    user="user",
    passwd="password",
    database="mydatabase"
)

mycursor = mydb.cursor()
target = str(sys.argv[1])
sql = " LOAD DATA INFILE %s IGNORE INTO TABLE customers FIELDS TERMINATED BY '\n' (HASH);"
mycursor.execute(sql,(target,))
mydb.commit()
#print(mydb.info())
#print(mycursor.info())
