# Updated with ThreatID for element
# To empty TRUNCATE TABLE element;`
import mysql.connector

mydb = mysql.connector.connect(
    host="localhost",
    user="user",
    passwd="password",
    #database="malwareDB"
)


mycursor = mydb.cursor()
mycursor.execute("CREATE DATABASE malwareDB")
mycursor.execute("USE DATABASE malwareDB")
mycursor.execute("""CREATE TABLE element 
	(severity INT(11), type VARCHAR(255), OS VARCHAR(255), 
		CategoryID VARCHAR(255), Rollupstatus VARCHAR(255), 
		Schemaversion VARCHAR(255), Date VARCHAR(255), 
		threatID BIGINT(20), Hash CHAR(32) PRIMARY KEY, 
		Location VARCHAR(255), subType VARCHAR(255))""")

# CREATE TABLE dllTable (
#   malware_dll_id SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT
#   , dll_name VARCHAR(80) NOT NULL
#   , PRIMARY KEY pk_dllTable (malware_dll_id)
# );
# # Linker Table, contains hash & dll_id to dllTable 
# CREATE TABLE malware2dll (
#   Hash char(32) NOT NULL
#   , malware_dll_id SMALLINT UNSIGNED NOT NULL
#   , PRIMARY KEY pk_malware2dllFeature (Hash, malware_dll_id)
# );

mydb.commit()
mycursor.execute("SHOW TABLES")

for x in mycursor:
    print(x)
